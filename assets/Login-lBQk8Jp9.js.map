{"version":3,"file":"Login-lBQk8Jp9.js","sources":["../../src/global/firebase/auth/getCurrentUser.js","../../src/global/firebase/auth/addAuthListener.js","../../src/global/firebase/auth/useAuth.js","../../src/global/firebase/auth/signIn.js","../../src/app/user-pages/Login.jsx"],"sourcesContent":["import firebase from \"../firebase\"\r\n\r\nexport const getCurrentUser = () => {\r\n  const user = firebase.auth().currentUser\r\n  if (!user) {\r\n    return null\r\n  }\r\n  return {\r\n    id: user.uid,\r\n  }\r\n}\r\n","import firebase from \"../firebase\"\r\nexport const addAuthListener = (callback) => {\r\n  const onChange = (user) => {\r\n    if (user) {\r\n      callback({})\r\n    } else {\r\n      callback(null)\r\n    }\r\n  }\r\n  return firebase.auth().onAuthStateChanged(onChange)\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport { addAuthListener } from \"./addAuthListener\"\r\nimport { getCurrentUser } from \"./getCurrentUser\"\r\nexport const useAuth = () => {\r\n  const [authInfo, setAuthInfo] = useState(() => {\r\n    const user = getCurrentUser()\r\n    const isLoading = !user\r\n    return {\r\n      isLoading,\r\n      user,\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = addAuthListener((user) => {\r\n      setAuthInfo({\r\n        isLoading: false,\r\n        user,\r\n      })\r\n    })\r\n    return unsubscribe\r\n  }, [])\r\n\r\n  return authInfo\r\n}\r\n","import firebase from \"../firebase\"\r\n\r\nexport const signIn = async (email, password) => {\r\n  try {\r\n    const result = await firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n    return {}\r\n  } catch (e) {\r\n    console.log(e.toString())\r\n    throw new Error(\"Error signing in: \" + e)\r\n  }\r\n}\r\n","import { Button, Form } from \"react-bootstrap\"\nimport { useState, useEffect } from \"react\"\nimport { signIn, useAuth } from \"../../global/firebase/auth\"\nimport { useNavigate } from \"react-router-dom\"\nimport Spinner from \"../shared/Spinner\"\nimport { getCurrentSetting } from \"../../global/firebase/setting\"\n\nexport const Login = ({}) => {\n  const [validationErrors, setValidationErrors] = useState({})\n  // const [cookies, setCookie] = useCookies([\"uid\", \"requestToken\"])\n  const { isLoading, user } = useAuth()\n  const isLogedIn = !!user\n\n  const [errorMessages, setErrorMessages] = useState([])\n  const [logingIn, setLogingIn] = useState(false)\n\n  // const [username, setUsername] = useState(\"\")\n  const [email, setEmail] = useState(\"\")\n  const [password, setPassword] = useState(\"\")\n  const navigate = useNavigate()\n  const main = () => {\n    setTimeout(() => {\n      try {\n        document.querySelector(`input.email`).focus()\n      } catch (e) {}\n    }, 512)\n    // console.log(config)\n  }\n  const doForgetPassword = () => {\n    setErrorMessages([\"Sayang sekali sepertinya anda harus tanya admin untuk reset password anda\"])\n  }\n  const onLogin = async () => {\n    setValidationErrors(null)\n    setErrorMessages([])\n    let errorCount = 0\n    let verrors = {}\n    if (email.length == 0) {\n      errorCount += 1\n      verrors = { ...verrors, email: { message: \"Email is required\" } }\n    }\n    if (password.length == 0) {\n      errorCount += 1\n      verrors = { ...verrors, password: { message: \"Password is required\" } }\n    }\n    console.log(errorCount)\n    if (errorCount > 0) {\n      setValidationErrors({ ...verrors })\n      console.log(validationErrors)\n      const firstField = Object.keys(validationErrors)[0]\n      setTimeout(() => {\n        try {\n          document.querySelector(`input.${firstField}`).focus()\n        } catch (e) {\n          console.error(e)\n        }\n      }, 512)\n    } else {\n      setLogingIn(true)\n      try {\n        await signIn(email, password)\n        // setCookie(\"uid\", result.id)\n        const { repoUrl, token, corsProxyUrl } = await getCurrentSetting()\n        localStorage.repoUrl = repoUrl\n        localStorage.token = token\n        localStorage.corsProxyUrl = corsProxyUrl\n        // navigate(\"/\")\n        document.location.href = \"/purple\"\n      } catch (e) {\n        const message = e.message.replace(\"FirebaseError:\", \"\").replace(\"Firebase:\", \"\")\n        setEmail(email)\n        setErrorMessages([message])\n        try {\n          document.querySelector(`input.email`).focus()\n        } catch (e) {}\n      }\n      setLogingIn(false)\n    }\n    // console.log(email, password)\n  }\n  useEffect(() => {\n    main()\n  }, [])\n\n  useEffect(() => {\n    if (isLogedIn) {\n      navigate(\"/\")\n      // document.location.reload()\n    }\n  }, [isLogedIn])\n  return (\n    <div>\n      <div className=\"d-flex align-items-center auth px-0\">\n        <div className=\"row w-100 mx-0\">\n          <div className=\"col-lg-4 mx-auto\">\n            <div className=\"auth-form-light text-left py-5 px-4 px-sm-5 twx-relative\">\n              <div className=\"brand-logo\">\n                <img className=\"twx-mx-auto\" src=\"/assets/images/logo/logo-dark.png\" alt=\"logo\" />\n              </div>\n              <div className=\"twx-text-center\">\n                {/* <h4 className=\"twx-mx-auto\">Hello! let's get started</h4> */}\n                <h6 className=\"font-weight-light\">Login untuk melanjutkan</h6>\n              </div>\n              {logingIn ? (\n                <>\n                  <Spinner independent={true} message=\"Sedang Login\" />\n                </>\n              ) : (\n                <Form\n                  className=\"pt-3\"\n                  onSubmit={(e) => {\n                    try {\n                      console.log(\"hello\")\n                      onLogin()\n                    } catch (e) {}\n                    return e.preventDefault()\n                  }}>\n                  <Form.Group className=\"d-flex search-field\">\n                    <Form.Control\n                      type=\"email\"\n                      placeholder=\"Email\"\n                      size=\"lg\"\n                      className=\"h-auto email\"\n                      onChange={(e) => setEmail(e.target.value)}\n                    />\n                  </Form.Group>\n                  <Form.Group className=\"d-flex search-field\">\n                    <Form.Control\n                      type=\"password\"\n                      placeholder=\"Kata Sandi\"\n                      size=\"lg\"\n                      className=\"h-auto password\"\n                      onChange={(e) => setPassword(e.target.value)}\n                    />\n                  </Form.Group>\n                  <Form.Group className=\"d-flex search-field\">\n                    {errorMessages.map((item, index) => {\n                      return (\n                        <div className=\"alert alert-danger\" key={index}>\n                          {item}\n                        </div>\n                      )\n                    })}\n                  </Form.Group>\n                  <div className=\"mt-3\">\n                    <Button\n                      type=\"submit\"\n                      size=\"sm\"\n                      className=\"text-center btn btn-block btn-primary btn-lg font-weight-medium auth-form-btn\">\n                      <span className=\"twx-mx-auto\">LOG IN</span>\n                    </Button>\n                  </div>\n                  {/* <div className=\"my-2 d-flex justify-content-between align-items-center\">\n                    <div className=\"form-check\">\n                      <label className=\"form-check-label text-muted\">\n                        <input type=\"checkbox\" className=\"form-check-input\" />\n                        <i className=\"input-helper\"></i>\n                        Keep me signed in\n                      </label>\n                    </div>\n                    <a href=\"!#\" onClick={(event) => event.preventDefault()} className=\"auth-link text-black\">\n                      Forgot password?\n                    </a>\n                  </div>\n                  <div className=\"mb-2\">\n                    <button type=\"button\" className=\"btn btn-block btn-facebook auth-form-btn\">\n                      <i className=\"mdi mdi-facebook mr-2\"></i>Connect using facebook\n                    </button>\n                  </div>\n                  <div className=\"text-center mt-4 font-weight-light\">\n                    Don't have an account?{\" \"}\n                    <Link to=\"/user-pages/register\" className=\"text-primary\">\n                      Create\n                    </Link>\n                  </div> */}\n                </Form>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Login\n"],"names":["getCurrentUser","user","firebase","addAuthListener","callback","onChange","useAuth","authInfo","setAuthInfo","useState","useEffect","signIn","email","password","result","e","Login","validationErrors","setValidationErrors","isLoading","isLogedIn","errorMessages","setErrorMessages","logingIn","setLogingIn","setEmail","setPassword","navigate","useNavigate","main","onLogin","errorCount","verrors","firstField","repoUrl","token","corsProxyUrl","getCurrentSetting","message","jsx","jsxs","Spinner","Form","item","index","Button"],"mappings":"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"}